###################################################################################################
# Template Doctor .env Example
#
# Copy to .env and fill in required secrets.
# For Azure deployment: Only the GitHub section is required - azd will fill in the rest.
# For local development: Use the Local Service section.
###################################################################################################

############################################
# GitHub OAuth / API Authentication (REQUIRED for Azure deployment)
############################################
GITHUB_CLIENT_ID=                          # OAuth app client ID (create at github.com/settings/developers)
GITHUB_CLIENT_SECRET=                      # OAuth app client secret  
GITHUB_TOKEN=                              # Personal Access Token (scopes: repo, workflow, read:org)
GH_WORKFLOW_TOKEN=                         # Workflow dispatch token (can be same as GITHUB_TOKEN)

# Admin Access Control
ADMIN_GITHUB_USERS=                        # Comma-separated GitHub usernames with admin privileges (e.g., youruser,teammate)
                                           # Required for /api/v4/admin/* and leaderboard endpoints

# Database
MONGODB_URI=                               # MongoDB connection string (will be set by azd for Cosmos DB, or use your own)

# Note: These values are automatically read by 'azd provision' and 'azd deploy'
# No need to use 'azd env set' if they're in .env!

############################################
# Azure Configuration (auto-filled by azd)
############################################
# These are set automatically by 'azd provision' - DO NOT edit manually
# AZURE_LOCATION=
# AZURE_SUBSCRIPTION_ID=
# AZURE_RESOURCE_GROUP=
# AZURE_CONTAINER_REGISTRY_ENDPOINT=
# SERVICE_WEB_URI=
# MONGODB_URI=
# COSMOS_ENDPOINT=
# COSMOS_ACCOUNT_NAME=

############################################
# Local Development Configuration (Docker Compose)
############################################
# PORT=3001                                 # Express backend port
# MONGODB_URI=mongodb://localhost:27017    # Local MongoDB
# MONGODB_DATABASE=template-doctor
# NODE_ENV=development

############################################
# Rate Limiting Configuration (optional)
############################################
# RATE_LIMIT_WINDOW_MS=60000               # Time window in milliseconds (default: 60000 = 1 minute)
# RATE_LIMIT_MAX_REQUESTS=100              # Max requests per window for standard endpoints (default: 100)
# RATE_LIMIT_STRICT_MAX=10                 # Max requests per window for expensive operations (default: 10)
# RATE_LIMIT_AUTH_MAX=20                   # Max requests per window for OAuth endpoints (default: 20)

############################################
# Legacy Configuration (kept for backwards compatibility)
############################################
PORT=4000                       # Frontend static server port
SERVE_FRONTEND=true             # If a local dev helper needs to serve the UI
BASE=http://localhost:7071      # Convenience for smoke script (Functions base URL)

############################################
# Azure Configuration (local dev placeholders)
############################################
AZURE_SUBSCRIPTION_ID=your_subscription_id_here
AZURE_TENANT_ID=your_tenant_id_here
AZURE_CLIENT_ID=your_azure_client_id_here

############################################
# GitHub OAuth / API Authentication
############################################
GITHUB_CLIENT_ID=your_github_oauth_client_id_here          # Required for browser OAuth flow
GITHUB_CLIENT_SECRET=your_github_oauth_client_secret_here  # Server-side token exchange (keep secret)
GITHUB_TOKEN=your_github_token_here                        # General PAT (scopes: repo, workflow) if needed
GH_WORKFLOW_TOKEN=your_github_token_here                   # Optional distinct token for workflow dispatch

############################################
# GitHub Repository Context
############################################
GITHUB_OWNER=your_github_org_or_user
GITHUB_REPO=template-doctor
# Target repository receiving workflow dispatch events (analysis jobs)
DISPATCH_TARGET_REPO=Template-Doctor/template-doctor

############################################
# Client Runtime Exposure (runtime-config endpoint)
# These are read & sent to the frontend; avoid sensitive secrets.
############################################
DEFAULT_RULE_SET=dod
REQUIRE_AUTH_FOR_RESULTS=true
AUTO_SAVE_RESULTS=false
ARCHIVE_ENABLED=true
ARCHIVE_COLLECTION=gallery
ARCHIVE_REPO_SLUG=Template-Doctor/centralized-collections-archive
ISSUE_AI_ENABLED=false                # Set true to enable AI issue assistance UI
DEPRECATED_MODELS=gpt-3.5-turbo,model-old-x

############################################
# Dynamic Overrides / Setup Endpoint
############################################
# Comma-separated GitHub usernames allowed to call /v4/setup to apply in-memory overrides.
SETUP_ALLOWED_USERS=yourusername,teammate
# GitHub Gist ID for persisting configuration overrides (create a private gist)
CONFIG_GIST_ID=your_gist_id_here

############################################
# Backend Address & Function Key (optional for local; used when frontend proxies to Azure)
############################################
# If deploying or pointing the UI at a remote Functions instance, set these so client obtains them.
TD_BACKEND_BASE_URL=http://localhost:7071
TD_BACKEND_FUNCTION_KEY=local-dev-func-key

############################################
# CORS / OAuth Allowed Origins (comma separated)
############################################
GITHUB_OAUTH_ALLOWED_ORIGINS=http://localhost:4000,http://localhost:8080

############################################
# Validation & Workflow Integration
############################################
GITHUB_WORKFLOW_FILE=validation-template.yml
GITHUB_REPO_BRANCH=main
# If the repository for validation differs:
# GITHUB_REPO_OWNER=YourOrg
# GITHUB_REPO_NAME=your-template-repo

############################################
# Optional Additional Flags / Debugging
############################################
# DEBUG_ANALYZE=1                # Extra logging for analysis handler
# DEBUG_VALIDATION=1             # (future) validation debug toggle

############################################
# Notes
# - Do NOT commit a real PAT / secrets.
# - For local-only experimentation TD_BACKEND_FUNCTION_KEY can be a placeholder.
# - The smoke script loads BASE and GITHUB_TOKEN automatically; export others to override.
############################################

